# Demo Infrastructure

è¿™æ˜¯ä¸€ä¸ªåŸºäº GitOps çš„ Kubernetes åŸºç¡€è®¾æ–½ç®¡ç†é¡¹ç›®ï¼Œä½¿ç”¨ ArgoCD è¿›è¡Œè‡ªåŠ¨åŒ–éƒ¨ç½²å’Œç®¡ç†ã€‚

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
demo-infra/
â”œâ”€â”€ cluster-bootstrap/          # é›†ç¾¤å®‰è£…ç›¸å…³
â”‚   â”œâ”€â”€ kubespray/             # kubespray é…ç½®
â”‚   â””â”€â”€ scripts/               # å®‰è£…è„šæœ¬
â””â”€â”€ gitops/                     # GitOps é…ç½®
    â”œâ”€â”€ infrastructure/         # åŸºç¡€è®¾æ–½å±‚
    â”‚   â”œâ”€â”€ istio/             # æœåŠ¡ç½‘æ ¼
    â”‚   â”œâ”€â”€ monitoring/        # ç›‘æ§æ ˆ
    â”‚   â”œâ”€â”€ networking/        # ç½‘ç»œé…ç½®
    â”‚   â”œâ”€â”€ security/          # å®‰å…¨ç»„ä»¶
    â”‚   â””â”€â”€ storage/           # å­˜å‚¨ç»„ä»¶
    â”œâ”€â”€ applications/          # ä¸šåŠ¡åº”ç”¨å±‚
    â”œâ”€â”€ argocd/                # ArgoCD é…ç½®
    â””â”€â”€ base/                  # åŸºç¡€é…ç½®
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. é›†ç¾¤å®‰è£…

```bash
# è¿è¡Œé›†ç¾¤å®‰è£…è„šæœ¬
cd cluster-bootstrap/scripts
./install-cluster.sh
```

### 2. åŸºç¡€è®¾æ–½éƒ¨ç½²

```bash
# éƒ¨ç½²åŸºç¡€è®¾æ–½ç»„ä»¶
kubectl apply -f gitops/base/
kubectl apply -f gitops/infrastructure/
```

### 3. è®¿é—®æœåŠ¡

- **ArgoCD**: http://your-server-ip:8080
- **Grafana**: http://your-server-ip:3000
- **Istio Gateway**: http://your-server-ip:80

## ğŸ“‹ ç»„ä»¶è¯´æ˜

### åŸºç¡€è®¾æ–½å±‚

- **Istio**: æœåŠ¡ç½‘æ ¼ï¼Œæä¾›æµé‡ç®¡ç†ã€å®‰å…¨ã€å¯è§‚æµ‹æ€§
- **MetalLB**: è´Ÿè½½å‡è¡¡å™¨ï¼Œä¸ºæœåŠ¡åˆ†é…å¤–éƒ¨ IP
- **Prometheus + Grafana**: ç›‘æ§å’Œå¯è§†åŒ–
- **Cert-Manager**: è¯ä¹¦ç®¡ç†
- **Longhorn**: åˆ†å¸ƒå¼å­˜å‚¨

### ä¸šåŠ¡åº”ç”¨å±‚

- **å¼€å‘ç¯å¢ƒ**: auth-service, chat-service ç­‰
- **é¢„å‘å¸ƒç¯å¢ƒ**: ä¸å¼€å‘ç¯å¢ƒç›¸åŒçš„æœåŠ¡
- **ç”Ÿäº§ç¯å¢ƒ**: ç”Ÿäº§çº§åˆ«çš„é…ç½®

## ğŸ”§ ç¯å¢ƒé…ç½®

### å¼€å‘ç¯å¢ƒ (2æ ¸8G ä¼˜åŒ–)

- æœ€å°èµ„æºæ¶ˆè€—
- å•å‰¯æœ¬éƒ¨ç½²
- ç¦ç”¨ä¸å¿…è¦çš„åŠŸèƒ½

### ç”Ÿäº§ç¯å¢ƒ

- é«˜å¯ç”¨é…ç½®
- å¤šå‰¯æœ¬éƒ¨ç½²
- å®Œæ•´åŠŸèƒ½å¯ç”¨

## ğŸ“– ä½¿ç”¨æŒ‡å—

### æ·»åŠ æ–°æœåŠ¡

1. åœ¨ `gitops/applications/` ä¸‹åˆ›å»ºæœåŠ¡é…ç½®
2. æ›´æ–° ArgoCD ApplicationSet
3. æ¨é€ä»£ç ï¼ŒArgoCD è‡ªåŠ¨éƒ¨ç½²

### ä¿®æ”¹é…ç½®

1. ç¼–è¾‘ç›¸åº”çš„ YAML æ–‡ä»¶
2. æäº¤å¹¶æ¨é€ä»£ç 
3. ArgoCD è‡ªåŠ¨åŒæ­¥å˜æ›´

## ğŸ› ï¸ ç»´æŠ¤

### æ£€æŸ¥é›†ç¾¤çŠ¶æ€

```bash
# æ£€æŸ¥åŸºç¡€è®¾æ–½çŠ¶æ€
./gitops/check-infrastructure.sh

# æ£€æŸ¥èµ„æºä½¿ç”¨
./gitops/monitor-resources.sh
```

### æ•…éšœæ’é™¤

- æŸ¥çœ‹ ArgoCD åº”ç”¨çŠ¶æ€
- æ£€æŸ¥ Pod æ—¥å¿—
- éªŒè¯ç½‘ç»œè¿é€šæ€§

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼ 